{"ast":null,"code":"/* eslint-disable no-unused-vars */ /* eslint-disable react-hooks/exhaustive-deps */import React,{useState,useEffect}from\"react\";import\"./Feed.css\";import supabase from\"../supabaseClient\";import{Link}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Feed(){const[posts,setPosts]=useState([]);const[sortBy,setSortBy]=useState(\"created_at\");const[commentText,setCommentText]=useState(\"\");useEffect(()=>{fetchPosts();},[sortBy]);const fetchPosts=async()=>{try{const{data:postsData,error:postsError}=await supabase.from(\"posts\").select(\"*\").order(sortBy,{ascending:false});if(postsError){console.error(\"Error fetching posts:\",postsError.message);return;}const postsWithComments=await Promise.all(postsData.map(async post=>{const{data:commentsData,error:commentsError}=await supabase.from(\"comments\").select(\"*\").eq(\"post_id\",post.id);if(commentsError){console.error(\"Error fetching comments for post:\",commentsError.message);return post;}return{...post,comments:commentsData};}));setPosts(postsWithComments);}catch(error){console.error(\"Error fetching posts:\",error.message);}};const handleSortChange=e=>{setSortBy(e.target.value);};const handleCommentSubmit=async postId=>{try{const{data,error}=await supabase.from(\"comments\").insert({post_id:postId,text:commentText});if(error){console.error(\"Error adding comment:\",error.message);return;}setCommentText(\"\");// Clear comment input after submission\n// Refresh posts after comment submission\nfetchPosts();}catch(error){console.error(\"Error adding comment:\",error.message);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"feed\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Feed\"}),/*#__PURE__*/_jsx(\"div\",{className:\"createpost-section\",children:/*#__PURE__*/_jsx(Link,{to:\"/create\",children:/*#__PURE__*/_jsx(\"button\",{className:\"createpost-button\",children:\"Create A Post\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"sort-controls\",children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Sort By:\",/*#__PURE__*/_jsxs(\"select\",{value:sortBy,onChange:handleSortChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"created_at\",children:\"Created Time\"}),/*#__PURE__*/_jsx(\"option\",{value:\"upvotes\",children:\"Upvotes Count\"})]})]})}),posts.map(post=>/*#__PURE__*/_jsxs(\"div\",{className:\"post\",children:[/*#__PURE__*/_jsx(\"h3\",{children:post.title}),/*#__PURE__*/_jsx(\"p\",{children:post.content}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Upvotes: \",post.upvotes]}),/*#__PURE__*/_jsxs(\"div\",{className:\"comments\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Comments:\"}),post.comments&&post.comments.map(comment=>/*#__PURE__*/_jsx(\"div\",{className:\"comment\",children:/*#__PURE__*/_jsx(\"p\",{children:comment.text})},comment.id))]}),/*#__PURE__*/_jsxs(\"form\",{className:\"comment-form\",onSubmit:e=>{e.preventDefault();handleCommentSubmit(post.id);},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:commentText,onChange:e=>setCommentText(e.target.value),placeholder:\"Add a comment...\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Comment\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"post-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"edit-button\",children:/*#__PURE__*/_jsx(Link,{to:\"/edit/\".concat(post.id),children:\"Edit\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-button\",children:/*#__PURE__*/_jsx(Link,{to:\"/delete/\".concat(post.id),children:\"Delete\"})})]})]},post.id))]});}export default Feed;","map":{"version":3,"names":["React","useState","useEffect","supabase","Link","jsx","_jsx","jsxs","_jsxs","Feed","posts","setPosts","sortBy","setSortBy","commentText","setCommentText","fetchPosts","data","postsData","error","postsError","from","select","order","ascending","console","message","postsWithComments","Promise","all","map","post","commentsData","commentsError","eq","id","comments","handleSortChange","e","target","value","handleCommentSubmit","postId","insert","post_id","text","className","children","to","onChange","title","content","upvotes","comment","onSubmit","preventDefault","type","placeholder","required","concat"],"sources":["C:/Users/Kai/Desktop/hobbyhub/src/Feed/Feed.js"],"sourcesContent":["/* eslint-disable no-unused-vars */\r\n/* eslint-disable react-hooks/exhaustive-deps */\r\nimport React, { useState, useEffect } from \"react\";\r\nimport \"./Feed.css\";\r\nimport supabase from \"../supabaseClient\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nfunction Feed() {\r\n  const [posts, setPosts] = useState([]);\r\n  const [sortBy, setSortBy] = useState(\"created_at\");\r\n  const [commentText, setCommentText] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    fetchPosts();\r\n  }, [sortBy]);\r\n\r\n  const fetchPosts = async () => {\r\n    try {\r\n      const { data: postsData, error: postsError } = await supabase\r\n        .from(\"posts\")\r\n        .select(\"*\")\r\n        .order(sortBy, { ascending: false });\r\n\r\n      if (postsError) {\r\n        console.error(\"Error fetching posts:\", postsError.message);\r\n        return;\r\n      }\r\n\r\n      const postsWithComments = await Promise.all(\r\n        postsData.map(async (post) => {\r\n          const { data: commentsData, error: commentsError } = await supabase\r\n            .from(\"comments\")\r\n            .select(\"*\")\r\n            .eq(\"post_id\", post.id);\r\n\r\n          if (commentsError) {\r\n            console.error(\r\n              \"Error fetching comments for post:\",\r\n              commentsError.message\r\n            );\r\n            return post;\r\n          }\r\n\r\n          return { ...post, comments: commentsData };\r\n        })\r\n      );\r\n\r\n      setPosts(postsWithComments);\r\n    } catch (error) {\r\n      console.error(\"Error fetching posts:\", error.message);\r\n    }\r\n  };\r\n\r\n  const handleSortChange = (e) => {\r\n    setSortBy(e.target.value);\r\n  };\r\n\r\n  const handleCommentSubmit = async (postId) => {\r\n    try {\r\n      const { data, error } = await supabase.from(\"comments\").insert({\r\n        post_id: postId,\r\n        text: commentText,\r\n      });\r\n\r\n      if (error) {\r\n        console.error(\"Error adding comment:\", error.message);\r\n        return;\r\n      }\r\n\r\n      setCommentText(\"\"); // Clear comment input after submission\r\n      // Refresh posts after comment submission\r\n      fetchPosts();\r\n    } catch (error) {\r\n      console.error(\"Error adding comment:\", error.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"feed\">\r\n      <h2>Feed</h2>\r\n      <div className=\"createpost-section\">\r\n        <Link to=\"/create\">\r\n          <button className=\"createpost-button\">Create A Post</button>\r\n        </Link>\r\n      </div>\r\n      <div className=\"sort-controls\">\r\n        <label>\r\n          Sort By:\r\n          <select value={sortBy} onChange={handleSortChange}>\r\n            <option value=\"created_at\">Created Time</option>\r\n            <option value=\"upvotes\">Upvotes Count</option>\r\n          </select>\r\n        </label>\r\n      </div>\r\n      {posts.map((post) => (\r\n        <div key={post.id} className=\"post\">\r\n          <h3>{post.title}</h3>\r\n          <p>{post.content}</p>\r\n          <p>Upvotes: {post.upvotes}</p>\r\n          <div className=\"comments\">\r\n            <h4>Comments:</h4>\r\n            {post.comments &&\r\n              post.comments.map((comment) => (\r\n                <div key={comment.id} className=\"comment\">\r\n                  <p>{comment.text}</p>\r\n                </div>\r\n              ))}\r\n          </div>\r\n          <form\r\n            className=\"comment-form\"\r\n            onSubmit={(e) => {\r\n              e.preventDefault();\r\n              handleCommentSubmit(post.id);\r\n            }}\r\n          >\r\n            <input\r\n              type=\"text\"\r\n              value={commentText}\r\n              onChange={(e) => setCommentText(e.target.value)}\r\n              placeholder=\"Add a comment...\"\r\n              required\r\n            />\r\n            <button type=\"submit\">Comment</button>\r\n          </form>\r\n          <div className=\"post-buttons\">\r\n            <button className=\"edit-button\">\r\n              <Link to={`/edit/${post.id}`}>Edit</Link>\r\n            </button>\r\n            <button className=\"delete-button\">\r\n              <Link to={`/delete/${post.id}`}>Delete</Link>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Feed;\r\n"],"mappings":"AAAA,oCACA,gDACA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,YAAY,CACnB,MAAO,CAAAC,QAAQ,KAAM,mBAAmB,CACxC,OAASC,IAAI,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAExC,QAAS,CAAAC,IAAIA,CAAA,CAAG,CACd,KAAM,CAACC,KAAK,CAAEC,QAAQ,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACW,MAAM,CAAEC,SAAS,CAAC,CAAGZ,QAAQ,CAAC,YAAY,CAAC,CAClD,KAAM,CAACa,WAAW,CAAEC,cAAc,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CAElDC,SAAS,CAAC,IAAM,CACdc,UAAU,CAAC,CAAC,CACd,CAAC,CAAE,CAACJ,MAAM,CAAC,CAAC,CAEZ,KAAM,CAAAI,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CACF,KAAM,CAAEC,IAAI,CAAEC,SAAS,CAAEC,KAAK,CAAEC,UAAW,CAAC,CAAG,KAAM,CAAAjB,QAAQ,CAC1DkB,IAAI,CAAC,OAAO,CAAC,CACbC,MAAM,CAAC,GAAG,CAAC,CACXC,KAAK,CAACX,MAAM,CAAE,CAAEY,SAAS,CAAE,KAAM,CAAC,CAAC,CAEtC,GAAIJ,UAAU,CAAE,CACdK,OAAO,CAACN,KAAK,CAAC,uBAAuB,CAAEC,UAAU,CAACM,OAAO,CAAC,CAC1D,OACF,CAEA,KAAM,CAAAC,iBAAiB,CAAG,KAAM,CAAAC,OAAO,CAACC,GAAG,CACzCX,SAAS,CAACY,GAAG,CAAC,KAAO,CAAAC,IAAI,EAAK,CAC5B,KAAM,CAAEd,IAAI,CAAEe,YAAY,CAAEb,KAAK,CAAEc,aAAc,CAAC,CAAG,KAAM,CAAA9B,QAAQ,CAChEkB,IAAI,CAAC,UAAU,CAAC,CAChBC,MAAM,CAAC,GAAG,CAAC,CACXY,EAAE,CAAC,SAAS,CAAEH,IAAI,CAACI,EAAE,CAAC,CAEzB,GAAIF,aAAa,CAAE,CACjBR,OAAO,CAACN,KAAK,CACX,mCAAmC,CACnCc,aAAa,CAACP,OAChB,CAAC,CACD,MAAO,CAAAK,IAAI,CACb,CAEA,MAAO,CAAE,GAAGA,IAAI,CAAEK,QAAQ,CAAEJ,YAAa,CAAC,CAC5C,CAAC,CACH,CAAC,CAEDrB,QAAQ,CAACgB,iBAAiB,CAAC,CAC7B,CAAE,MAAOR,KAAK,CAAE,CACdM,OAAO,CAACN,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAACO,OAAO,CAAC,CACvD,CACF,CAAC,CAED,KAAM,CAAAW,gBAAgB,CAAIC,CAAC,EAAK,CAC9BzB,SAAS,CAACyB,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,CAC3B,CAAC,CAED,KAAM,CAAAC,mBAAmB,CAAG,KAAO,CAAAC,MAAM,EAAK,CAC5C,GAAI,CACF,KAAM,CAAEzB,IAAI,CAAEE,KAAM,CAAC,CAAG,KAAM,CAAAhB,QAAQ,CAACkB,IAAI,CAAC,UAAU,CAAC,CAACsB,MAAM,CAAC,CAC7DC,OAAO,CAAEF,MAAM,CACfG,IAAI,CAAE/B,WACR,CAAC,CAAC,CAEF,GAAIK,KAAK,CAAE,CACTM,OAAO,CAACN,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAACO,OAAO,CAAC,CACrD,OACF,CAEAX,cAAc,CAAC,EAAE,CAAC,CAAE;AACpB;AACAC,UAAU,CAAC,CAAC,CACd,CAAE,MAAOG,KAAK,CAAE,CACdM,OAAO,CAACN,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAACO,OAAO,CAAC,CACvD,CACF,CAAC,CAED,mBACElB,KAAA,QAAKsC,SAAS,CAAC,MAAM,CAAAC,QAAA,eACnBzC,IAAA,OAAAyC,QAAA,CAAI,MAAI,CAAI,CAAC,cACbzC,IAAA,QAAKwC,SAAS,CAAC,oBAAoB,CAAAC,QAAA,cACjCzC,IAAA,CAACF,IAAI,EAAC4C,EAAE,CAAC,SAAS,CAAAD,QAAA,cAChBzC,IAAA,WAAQwC,SAAS,CAAC,mBAAmB,CAAAC,QAAA,CAAC,eAAa,CAAQ,CAAC,CACxD,CAAC,CACJ,CAAC,cACNzC,IAAA,QAAKwC,SAAS,CAAC,eAAe,CAAAC,QAAA,cAC5BvC,KAAA,UAAAuC,QAAA,EAAO,UAEL,cAAAvC,KAAA,WAAQgC,KAAK,CAAE5B,MAAO,CAACqC,QAAQ,CAAEZ,gBAAiB,CAAAU,QAAA,eAChDzC,IAAA,WAAQkC,KAAK,CAAC,YAAY,CAAAO,QAAA,CAAC,cAAY,CAAQ,CAAC,cAChDzC,IAAA,WAAQkC,KAAK,CAAC,SAAS,CAAAO,QAAA,CAAC,eAAa,CAAQ,CAAC,EACxC,CAAC,EACJ,CAAC,CACL,CAAC,CACLrC,KAAK,CAACoB,GAAG,CAAEC,IAAI,eACdvB,KAAA,QAAmBsC,SAAS,CAAC,MAAM,CAAAC,QAAA,eACjCzC,IAAA,OAAAyC,QAAA,CAAKhB,IAAI,CAACmB,KAAK,CAAK,CAAC,cACrB5C,IAAA,MAAAyC,QAAA,CAAIhB,IAAI,CAACoB,OAAO,CAAI,CAAC,cACrB3C,KAAA,MAAAuC,QAAA,EAAG,WAAS,CAAChB,IAAI,CAACqB,OAAO,EAAI,CAAC,cAC9B5C,KAAA,QAAKsC,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvBzC,IAAA,OAAAyC,QAAA,CAAI,WAAS,CAAI,CAAC,CACjBhB,IAAI,CAACK,QAAQ,EACZL,IAAI,CAACK,QAAQ,CAACN,GAAG,CAAEuB,OAAO,eACxB/C,IAAA,QAAsBwC,SAAS,CAAC,SAAS,CAAAC,QAAA,cACvCzC,IAAA,MAAAyC,QAAA,CAAIM,OAAO,CAACR,IAAI,CAAI,CAAC,EADbQ,OAAO,CAAClB,EAEb,CACN,CAAC,EACD,CAAC,cACN3B,KAAA,SACEsC,SAAS,CAAC,cAAc,CACxBQ,QAAQ,CAAGhB,CAAC,EAAK,CACfA,CAAC,CAACiB,cAAc,CAAC,CAAC,CAClBd,mBAAmB,CAACV,IAAI,CAACI,EAAE,CAAC,CAC9B,CAAE,CAAAY,QAAA,eAEFzC,IAAA,UACEkD,IAAI,CAAC,MAAM,CACXhB,KAAK,CAAE1B,WAAY,CACnBmC,QAAQ,CAAGX,CAAC,EAAKvB,cAAc,CAACuB,CAAC,CAACC,MAAM,CAACC,KAAK,CAAE,CAChDiB,WAAW,CAAC,kBAAkB,CAC9BC,QAAQ,MACT,CAAC,cACFpD,IAAA,WAAQkD,IAAI,CAAC,QAAQ,CAAAT,QAAA,CAAC,SAAO,CAAQ,CAAC,EAClC,CAAC,cACPvC,KAAA,QAAKsC,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BzC,IAAA,WAAQwC,SAAS,CAAC,aAAa,CAAAC,QAAA,cAC7BzC,IAAA,CAACF,IAAI,EAAC4C,EAAE,UAAAW,MAAA,CAAW5B,IAAI,CAACI,EAAE,CAAG,CAAAY,QAAA,CAAC,MAAI,CAAM,CAAC,CACnC,CAAC,cACTzC,IAAA,WAAQwC,SAAS,CAAC,eAAe,CAAAC,QAAA,cAC/BzC,IAAA,CAACF,IAAI,EAAC4C,EAAE,YAAAW,MAAA,CAAa5B,IAAI,CAACI,EAAE,CAAG,CAAAY,QAAA,CAAC,QAAM,CAAM,CAAC,CACvC,CAAC,EACN,CAAC,GApCEhB,IAAI,CAACI,EAqCV,CACN,CAAC,EACC,CAAC,CAEV,CAEA,cAAe,CAAA1B,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}