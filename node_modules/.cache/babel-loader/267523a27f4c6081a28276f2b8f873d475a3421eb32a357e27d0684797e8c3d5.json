{"ast":null,"code":"import React,{useState}from\"react\";import{Link}from\"react-router-dom\";import\"./CreatePost.css\";import supabase from\"../supabaseClient\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function CreatePost(_ref){let{onUpdate}=_ref;const[title,setTitle]=useState(\"\");const[content,setContent]=useState(\"\");const[image,setImage]=useState(null);const handlePost=async e=>{e.preventDefault();try{// Upload image to Supabase storage\nlet imageUrl=null;if(image){const{data,error}=await supabase.storage.from(\"posts\").upload(\"images/\".concat(image.name),image);if(error){console.error(\"Error uploading image:\",error.message);return;}imageUrl=data.Key;}// Insert the post into the database\nconst{data:postData,error:postError}=await supabase.from(\"posts\").insert([{title,content,image_url:imageUrl}]);if(postError){console.error(\"Error creating post:\",postError.message);return;}// Clear the form fields after successful submission\nsetTitle(\"\");setContent(\"\");setImage(null);// Notify the parent component to update the feed\nonUpdate();}catch(error){console.error(\"Error creating post:\",error.message);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"createpost\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"backfeed-section\",children:/*#__PURE__*/_jsx(Link,{to:\"/feed\",children:/*#__PURE__*/_jsx(\"button\",{className:\"backfeed-button\",children:\"Back to Feed\"})})}),/*#__PURE__*/_jsxs(\"form\",{className:\"createpost-form\",onSubmit:handlePost,children:[/*#__PURE__*/_jsx(\"input\",{className:\"title-field\",type:\"text\",placeholder:\"Title\",value:title,onChange:e=>setTitle(e.target.value)}),/*#__PURE__*/_jsx(\"div\",{className:\"textarea-section\",children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"What's on your mind? (optional)\",value:content,onChange:e=>setContent(e.target.value)})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:e=>setImage(e.target.files[0])}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"post-button\",children:\"Post\"})]})]});}export default CreatePost;","map":{"version":3,"names":["React","useState","Link","supabase","jsx","_jsx","jsxs","_jsxs","CreatePost","_ref","onUpdate","title","setTitle","content","setContent","image","setImage","handlePost","e","preventDefault","imageUrl","data","error","storage","from","upload","concat","name","console","message","Key","postData","postError","insert","image_url","className","children","to","onSubmit","type","placeholder","value","onChange","target","accept","files"],"sources":["C:/Users/Kai/Desktop/hobbyhub/src/CreatePost/CreatePost.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport \"./CreatePost.css\";\r\nimport supabase from \"../supabaseClient\";\r\n\r\nfunction CreatePost({ onUpdate }) {\r\n  const [title, setTitle] = useState(\"\");\r\n  const [content, setContent] = useState(\"\");\r\n  const [image, setImage] = useState(null);\r\n\r\n  const handlePost = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      // Upload image to Supabase storage\r\n      let imageUrl = null;\r\n      if (image) {\r\n        const { data, error } = await supabase.storage\r\n          .from(\"posts\")\r\n          .upload(`images/${image.name}`, image);\r\n\r\n        if (error) {\r\n          console.error(\"Error uploading image:\", error.message);\r\n          return;\r\n        }\r\n\r\n        imageUrl = data.Key;\r\n      }\r\n\r\n      // Insert the post into the database\r\n      const { data: postData, error: postError } = await supabase\r\n        .from(\"posts\")\r\n        .insert([{ title, content, image_url: imageUrl }]);\r\n\r\n      if (postError) {\r\n        console.error(\"Error creating post:\", postError.message);\r\n        return;\r\n      }\r\n\r\n      // Clear the form fields after successful submission\r\n      setTitle(\"\");\r\n      setContent(\"\");\r\n      setImage(null);\r\n\r\n      // Notify the parent component to update the feed\r\n      onUpdate();\r\n    } catch (error) {\r\n      console.error(\"Error creating post:\", error.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"createpost\">\r\n      <div className=\"backfeed-section\">\r\n        <Link to=\"/feed\">\r\n          <button className=\"backfeed-button\">Back to Feed</button>\r\n        </Link>\r\n      </div>\r\n      <form className=\"createpost-form\" onSubmit={handlePost}>\r\n        <input\r\n          className=\"title-field\"\r\n          type=\"text\"\r\n          placeholder=\"Title\"\r\n          value={title}\r\n          onChange={(e) => setTitle(e.target.value)}\r\n        />\r\n        <div className=\"textarea-section\">\r\n          <textarea\r\n            placeholder=\"What's on your mind? (optional)\"\r\n            value={content}\r\n            onChange={(e) => setContent(e.target.value)}\r\n          />\r\n        </div>\r\n\r\n        <input\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          onChange={(e) => setImage(e.target.files[0])}\r\n        />\r\n        <button type=\"submit\" className=\"post-button\">\r\n          Post\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CreatePost;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}